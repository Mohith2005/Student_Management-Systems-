<?php require_once 'check_student_auth.php'; ?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Lectures</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plyr/3.7.8/plyr.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/plyr/3.7.8/plyr.css" />
</head>
<body class="bg-gray-100">
    <?php include 'student_header.php'; ?>
    <!-- Header -->
    <header class="bg-blue-500 text-white p-4">
        <h1 class="text-2xl">Introduction to Computer Science</h1>
        <a href="#" class="text-sm text-white hover:text-gray-200">‚Üê Back to Course</a>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <h2 class="text-xl mb-4">Lecture 1: Course Overview</h2>
        
        <!-- Video Player with Controls -->
        <div class="bg-black rounded-lg overflow-hidden mb-6">
            <div id="player-container" class="relative">
                <!-- Using a placeholder video source -->
                <video id="player" class="w-full aspect-video" playsinline controls>
                    <source src="/api/placeholder/800/450" type="video/mp4" />
                    Your browser does not support the video tag.
                </video>
                
                <!-- Video Controls Overlay -->
                <div class="video-features absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent text-white p-4 opacity-0 hover:opacity-100 transition-opacity">
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center gap-4">
                            <!-- Current timestamp -->
                            <span id="current-time" class="text-sm">00:00</span>
                            <!-- Speed control dropdown -->
                            <select id="playback-speed" class="bg-transparent border border-white rounded text-xs p-1">
                                <option value="0.5">0.5x</option>
                                <option value="1" selected>1x</option>
                                <option value="1.5">1.5x</option>
                                <option value="2">2x</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-4">
                            <!-- Quality selector -->
                            <select id="quality-selector" class="bg-transparent border border-white rounded text-xs p-1">
                                <option value="360">360p</option>
                                <option value="720" selected>720p</option>
                                <option value="1080">1080p</option>
                            </select>
                            <!-- Duration -->
                            <span id="duration" class="text-sm">45:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Navigation and Features -->
        <div class="bg-white rounded-lg shadow mb-8 p-4">
            <div class="flex flex-wrap justify-between items-center mb-4">
                <!-- Video Timestamps -->
                <div class="space-y-2 mb-4 lg:mb-0">
                    <h3 class="font-semibold">Lecture Sections:</h3>
                    <ul class="space-y-1">
                        <li><button class="text-blue-500 hover:underline text-sm" data-time="0">00:00 - Introduction</button></li>
                        <li><button class="text-blue-500 hover:underline text-sm" data-time="300">05:00 - Course Objectives</button></li>
                        <li><button class="text-blue-500 hover:underline text-sm" data-time="987">16:27 - Assessment Criteria</button></li>
                        <li><button class="text-blue-500 hover:underline text-sm" data-time="1800">30:00 - Programming Basics</button></li>
                    </ul>
                </div>
                
                <!-- Additional Features -->
                <div class="space-y-2">
                    <div class="flex items-center gap-2">
                        <button id="download-transcript" class="bg-gray-200 hover:bg-gray-300 text-gray-800 rounded px-3 py-1 text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download Transcript
                        </button>
                        <button id="toggle-captions" class="bg-gray-200 hover:bg-gray-300 text-gray-800 rounded px-3 py-1 text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                            </svg>
                            Toggle Captions
                        </button>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="bookmark" class="bg-gray-200 hover:bg-gray-300 text-gray-800 rounded px-3 py-1 text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                            </svg>
                            Add Bookmark
                        </button>
                        <button id="share-video" class="bg-gray-200 hover:bg-gray-300 text-gray-800 rounded px-3 py-1 text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                            </svg>
                            Share
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Description -->
        <p class="text-gray-700 mb-8">
            This lecture provides an overview of the course structure, learning objectives, and what you can expect to learn throughout the semester.
        </p>

        <!-- Comments Section -->
        <section class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">Discussion</h3>
            
            <!-- Comment Form -->
            <div class="mb-6">
                <textarea 
                    class="w-full p-3 border rounded-lg mb-2" 
                    rows="3" 
                    placeholder="Add your question or thoughts..."></textarea>
                <button class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Post Comment
                </button>
            </div>

            <!-- Comments List -->
            <div class="space-y-4">
                <!-- Sample Faculty Comment -->
                <div class="border-b pb-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center">
                            F
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <span class="font-semibold">Dr. Smith</span>
                                <span class="text-sm text-gray-500">Faculty</span>
                                <span class="text-sm text-gray-500">2 hours ago</span>
                            </div>
                            <p class="mt-1">
                                Hello class! Feel free to post any questions you have about the course overview. I'll be checking regularly to address your queries.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Sample Student Comment -->
                <div class="border-b pb-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center">
                            J
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <span class="font-semibold">John Doe</span>
                                <span class="text-sm text-gray-500">Student</span>
                                <span class="text-sm text-gray-500">1 hour ago</span>
                            </div>
                            <p class="mt-1">
                                Could you please explain more about the assessment criteria mentioned at 16:27? I'm not clear about the project requirements.
                            </p>
                            <!-- Reply -->
                            <div class="mt-3 ml-8">
                                <div class="flex items-start gap-3">
                                    <div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center">
                                        F
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2">
                                            <span class="font-semibold">Dr. Smith</span>
                                            <span class="text-sm text-gray-500">Faculty</span>
                                            <span class="text-sm text-gray-500">30 mins ago</span>
                                        </div>
                                        <p class="mt-1">
                                            I'll clarify the project requirements in our next class. The main focus will be on implementing the concepts we discuss in weeks 3-6.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Initialize Plyr video player
        document.addEventListener('DOMContentLoaded', function() {
            const player = new Plyr('#player', {
                controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'captions', 'settings', 'pip', 'fullscreen'],
                settings: ['captions', 'quality', 'speed']
            });

            // Handle timestamp navigation
            document.querySelectorAll('[data-time]').forEach(button => {
                button.addEventListener('click', () => {
                    const timestamp = parseInt(button.getAttribute('data-time'));
                    player.currentTime = timestamp;
                    player.play();
                });
            });

            // Playback speed control
            document.getElementById('playback-speed').addEventListener('change', function() {
                player.speed = parseFloat(this.value);
            });

            // Update current time display
            player.on('timeupdate', () => {
                const currentTime = Math.floor(player.currentTime);
                const minutes = Math.floor(currentTime / 60);
                const seconds = currentTime % 60;
                document.getElementById('current-time').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            });

            // Handle captions toggle
            let captionsOn = false;
            document.getElementById('toggle-captions').addEventListener('click', function() {
                captionsOn = !captionsOn;
                player.toggleCaptions(captionsOn);
                this.classList.toggle('bg-blue-500');
                this.classList.toggle('text-white');
                this.classList.toggle('bg-gray-200');
                this.classList.toggle('text-gray-800');
            });

            // Simulate bookmark functionality
            document.getElementById('bookmark').addEventListener('click', function() {
                const currentTime = player.currentTime;
                alert(`Bookmarked at ${Math.floor(currentTime / 60)}:${Math.floor(currentTime % 60).toString().padStart(2, '0')}`);
            });

            // Simulate download transcript
            document.getElementById('download-transcript').addEventListener('click', function() {
                alert('Transcript download started');
            });

            // Simulate share functionality
            document.getElementById('share-video').addEventListener('click', function() {
                alert('Share dialog opened with current video position');
            });

            // Quality selector (simulated)
            document.getElementById('quality-selector').addEventListener('change', function() {
                const quality = this.value;
                alert(`Video quality changed to ${quality}p`);
            });
        });
    </script>
</body>
</html>